CREATE DATABASE college_db;
USE college_db;

CREATE TABLE Students (
    student_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50),
    email VARCHAR(100) UNIQUE,
    birth_date DATE
);

CREATE TABLE Courses (
    course_id INT AUTO_INCREMENT PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL,
    credits INT CHECK (credits BETWEEN 1 AND 10)
);

CREATE TABLE Enrollments (
    enrollment_id INT AUTO_INCREMENT PRIMARY KEY,
    student_id INT,
    course_id INT,
    enrollment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    grade CHAR(1),
    FOREIGN KEY (student_id) REFERENCES Students(student_id) ON DELETE CASCADE,
    FOREIGN KEY (course_id) REFERENCES Courses(course_id),
    CHECK (grade IN ('A', 'B', 'C', 'D', 'F'))
);



CREATE INDEX idx_email ON Students(email);


CREATE VIEW StudentCourseView AS
SELECT s.first_name, s.last_name, c.course_name, e.grade
FROM Students s
JOIN Enrollments e ON s.student_id = e.student_id
JOIN Courses c ON c.course_id = e.course_id;

INSERT INTO Students (first_name, last_name, email, birth_date) VALUES
('Alice', 'Walker', 'alice@example.com', '2001-05-12'),
('Bob', 'Smith', 'bob@example.com', '2002-11-23'),
('Charlie', 'Brown', 'charlie@example.com', '2003-02-15');

INSERT INTO Courses (course_name, credits) VALUES
('Database Systems', 4),
('Operating Systems', 3),
('Computer Networks', 5);

INSERT INTO Enrollments (student_id, course_id, grade) VALUES
(1, 1, 'A'),
(2, 2, 'B'),
(3, 3, 'C');


SELECT * FROM Students;


SELECT * FROM StudentCourseView;


UPDATE Enrollments SET grade = 'A' WHERE student_id = 2 AND course_id = 2;


DELETE FROM Students WHERE student_id = 3;


SELECT course_id, COUNT(*) AS total_enrolled FROM Enrollments GROUP BY course_id;


SELECT * FROM Students WHERE email LIKE '%@example.com';


SELECT email FROM Students
UNION
SELECT 'guest@example.com';


SELECT AVG(credits) AS avg_credits FROM Courses;


SELECT s.first_name, s.last_name, e.grade
FROM Students s
JOIN Enrollments e ON s.student_id = e.student_id
WHERE e.grade = 'A';


SELECT first_name, last_name, birth_date
FROM Students
WHERE birth_date > '2002-01-01';

