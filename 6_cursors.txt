
CREATE TABLE O_rollcall (
    roll_no NUMBER,
    name VARCHAR2(20)
);


CREATE TABLE N_rollcall (
    roll_no NUMBER,
    name VARCHAR2(20)
);


INSERT INTO O_rollcall VALUES (1, 'Minal');
INSERT INTO O_rollcall VALUES (2, 'Sunil');
INSERT INTO O_rollcall VALUES (3, 'Sarika');

INSERT INTO N_rollcall VALUES (1, 'Minal');


DECLARE
   
    CURSOR cur_merge(p_roll NUMBER) IS
        SELECT roll_no, name FROM O_rollcall
        WHERE roll_no = p_roll;

    v_roll NUMBER;
    v_name VARCHAR2(20);
BEGIN
    FOR rec IN (SELECT * FROM O_rollcall) LOOP
        
        SELECT COUNT(*) INTO v_roll FROM N_rollcall WHERE roll_no = rec.roll_no;

      
        IF v_roll = 0 THEN
            OPEN cur_merge(rec.roll_no);
            FETCH cur_merge INTO v_roll, v_name;
            INSERT INTO N_rollcall VALUES (v_roll, v_name);
            CLOSE cur_merge;
        END IF;
    END LOOP;

    DBMS_OUTPUT.PUT_LINE('Data merged successfully.');
END;
/


SELECT * FROM N_rollcall;

