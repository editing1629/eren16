create table borrower(
    rollno number(5),
    name varchar(20),
    date_of_issue date,
    bookname varchar(20),
    status varchar(5)
);


insert into borrower values
(1, 'Minal', '03-APR-24', 'DBMS', 'I');

insert into borrower values (2, 'Rajesh', '11-JUN-24', 'Python', 'I');

insert into borrower values (3, 'Suraj', '13-JUL-24', 'Java', 'I');

insert into borrower values (4, 'Savita', '22-JUL-24', 'Python', 'I');


select * from borrower;


create table fine(
    rollno number(5),
    submission_date date,
    amt number(5)
);
ed path copy booknew.sql

declare
    roll_no number(3) := &rollno;
    bookname varchar2(20) := '&bookname';
    no_of_days number(3);
    issuedate date;
    return_date date := to_date(sysdate, 'DD-MM-YYYY');
    fine_amt number(5) := 0;
begin
    dbms_output.put_line('Return Date : ' || return_date);

    select date_of_issue into issuedate
    from borrower
    where rollno = roll_no;

    no_of_days := sysdate - to_date(issuedate);
    dbms_output.put_line('No of Days for Book Possession: ' || no_of_days);

    if (no_of_days > 15 and no_of_days <= 30) then
        fine_amt := no_of_days * 5;
    elsif no_of_days > 30 then
        fine_amt := no_of_days * 50;
    end if;

    dbms_output.put_line('Fine: ' || fine_amt);

    update borrower set status = 'R' where rollno = roll_no;

    if fine_amt > 0 then
        insert into fine values (roll_no, sysdate, fine_amt);
    end if;

exception
    when no_data_found then
        dbms_output.put_line('Record not found');
end;
/

@path copy booknew.sql


select * from borrower;


select * from fine;

